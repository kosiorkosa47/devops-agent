# Velero Helm Values - Backup to MinIO
configuration:
  # Provider for MinIO (S3-compatible)
  provider: aws
  
  # Backup storage location
  backupStorageLocation:
    - name: default
      provider: aws
      bucket: velero-backups
      config:
        region: us-east-1  # MinIO doesn't care but required
        s3ForcePathStyle: true
        s3Url: http://minio.storage.svc.cluster.local:9000
        publicUrl: https://minio.yourdomain.com
  
  # Volume snapshot location (if using CSI snapshots)
  volumeSnapshotLocation:
    - name: default
      provider: aws
      config:
        region: us-east-1

  # Backup retention
  defaultBackupTTL: 720h  # 30 days

# Credentials for MinIO
credentials:
  useSecret: true
  secretContents:
    cloud: |
      [default]
      aws_access_key_id=minioadmin
      aws_secret_access_key=changeme-generate-strong-password

# Resource limits
resources:
  requests:
    cpu: 500m
    memory: 128Mi
  limits:
    cpu: 1000m
    memory: 512Mi

# Schedules - automated backups
schedules:
  # Daily full backup
  daily-backup:
    disabled: false
    schedule: "0 2 * * *"  # 2 AM daily
    template:
      ttl: "720h"  # 30 days
      includedNamespaces:
        - production
        - staging
        - data
      excludedResources:
        - events
        - events.events.k8s.io
  
  # Hourly incremental backup for critical namespaces
  hourly-critical:
    disabled: false
    schedule: "0 * * * *"  # Every hour
    template:
      ttl: "168h"  # 7 days
      includedNamespaces:
        - production
        - data
      excludedResources:
        - events

# Monitoring
metrics:
  enabled: true
  serviceMonitor:
    enabled: true

# Node selector for velero pods
nodeSelector: {}

# Init containers for plugins
initContainers:
  - name: velero-plugin-for-aws
    image: velero/velero-plugin-for-aws:v1.9.0
    imagePullPolicy: IfNotPresent
    volumeMounts:
      - mountPath: /target
        name: plugins
